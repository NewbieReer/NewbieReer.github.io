<!DOCTYPE html>
<html lang="en">
<head>
<script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","version":"8.6.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta name="description" content="fffffffffffffffffffffffffff">
<meta property="og:type" content="article">
<meta property="og:title" content="Fuck_World">
<meta property="og:url" content="http://example.com/2021/07/19/Hellworld/index.html">
<meta property="og:site_name" content="NewbieReer&#39;s blog">
<meta property="og:description" content="fffffffffffffffffffffffffff">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-07-19T10:16:00.000Z">
<meta property="article:modified_time" content="2021-10-19T06:44:16.810Z">
<meta property="article:author" content="NewbieReer">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2021/07/19/Hellworld/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2021/07/19/Hellworld/","path":"2021/07/19/Hellworld/","title":"Fuck_World"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Fuck_World | NewbieReer's blog</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">NewbieReer's blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags<span class="badge">0</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories<span class="badge">0</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives<span class="badge">7</span></a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <!-- require APlayer -->
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
      <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
      <!-- require MetingJS-->
      <script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script> 
      <!--������playlist������ַ-->   


      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="NewbieReer"
      src="/images/touxiang.jpg">
  <p class="site-author-name" itemprop="name">NewbieReer</p>
  <div class="site-description" itemprop="description">一篇诗，一斗酒，一曲长歌，一剑天涯</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://psyduck0409.github.io/" title="DaiDai → https:&#x2F;&#x2F;psyduck0409.github.io&#x2F;" rel="noopener" target="_blank">DaiDai</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://justloseit.top/" title="Joker → http:&#x2F;&#x2F;justloseit.top&#x2F;" rel="noopener" target="_blank">Joker</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://s0uthwood.github.io/" title="s0uthwood&#39;s Blog → https:&#x2F;&#x2F;s0uthwood.github.io&#x2F;" rel="noopener" target="_blank">s0uthwood's Blog</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://kfxp12138.github.io/" title="triplewings → https:&#x2F;&#x2F;kfxp12138.github.io&#x2F;" rel="noopener" target="_blank">triplewings</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://fyhssgss.github.io/" title="ssgss → https:&#x2F;&#x2F;fyhssgss.github.io&#x2F;" rel="noopener" target="_blank">ssgss</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://xz1548.github.io/" title="xz1548 → https:&#x2F;&#x2F;xz1548.github.io&#x2F;" rel="noopener" target="_blank">xz1548</a>
      </span>
  </div>



          </div>
        </div>
      </div>
      <meting-js
          style="display: none"
          server="netease"
          type="playlist" 
          id="6987135743"
          mini="true"
          fixed="false"
          list-folded="false"
          autoplay="true"
          volume="0.2"
          theme="#FADFA3"
          order="random"
          loop="all"
          preload="auto"
          mutex="true">
      </meting-js>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/07/19/Hellworld/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/touxiang.jpg">
      <meta itemprop="name" content="NewbieReer">
      <meta itemprop="description" content="一篇诗，一斗酒，一曲长歌，一剑天涯">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NewbieReer's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Fuck_World
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-07-19 18:16:00" itemprop="dateCreated datePublished" datetime="2021-07-19T18:16:00+08:00">2021-07-19</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-10-19 14:44:16" itemprop="dateModified" datetime="2021-10-19T14:44:16+08:00">2021-10-19</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>fffffffffffffffffffffffffff</p>
<span id="more"></span>

<p>fffffffffffffffffffffff</p>
<!--

**2020 第五空间**

**一、nop**

sub_80485C4是一些花指令，不知道是什么原理，它就是可以成功干扰ida反编译，明明eax=0x40，却被识别成了lseek，现在搞明白了，因为最开始分析的时候ida把存放调用参数和进行系统调用识别成了在两个函数里面，因此需要ida重新分析这里（但并不是简单的u+c），没有找到比较好的解决方法，要不然把去花后的修改文件写入，在用ida打开修改过的文件分析。或者就是shift+;修改系统注释，注意是在汇编层面改。

[PID, PPID, PGID与SID_个人博客-CSDN博客](https://blog.csdn.net/Justdoit123_/article/details/101347971)

**系统调用：eax存入0x80， ebx  ecx  edx存入第1、2、3个参数**

sub_80485C4
int a = get_pid();    //系统调用号 0x14
int b = get_ppid();    //0x40
int c = get_sid(a);    //0x93        
if(c == b){
    return;
}
else{
    exit(0);
}



sub_804857B
if(gtty()<0){
    return;
}
else{
    ???;
}


gtty():

**内容简介**
未实现系统调用
**描述**
These system calls are not implemented in the Linux 2.4 kernel.
**返回值**
These system calls always return -1 and set *errno* to **ENOSYS**.

**应该是某种反调试吧**

将80485c4 和 nop掉

令dword_804A038在sub_8048691前面==0x8048765，sub_8048691函数将0x8048765处的值nop掉

python
flag = 0x8048765
flag -= 1
flag += 858993460
flag -= 1
flag -= 1
print(flag)

**二、rev**

import angr
import sys
import claripy

start_addr = 0x400450
project = angr.Project('./rev_v2',auto_load_libs = False)
argv1 = claripy.BVS('argv1',50*8)
initial_state = project.factory.entry_state(args = ["./rev_v2",argv1])
good_addr = 0x400488

simulation = project.factory.simgr(initial_state)
simulation.explore(find = good_addr, void = 0x400471)
if simulation.found:
    for i in simulation.found:
        print("[+] Success! Solution is:")
        solution_state = simulation.found[0]
        solution = solution_state.posix.dumps(sys.stdin.fileno())
        print(solution)
        solution = i.solver.eval(argv1, cast_to=bytes)
        print(solution)

#ctf{ropchain_is_g00d}



**2021 flare-on**

**三、2**

def ror(a,b):
    return (((a<<(8-b))|(a>>b))&0xff)
def rol(a,b):
    return ((a<<b)|(a>>(8-b)))&0xff

png = [0x89,0x50,0x4e,0x47,0x0d,0x0a,0x1a,0x0a]
res = [0xC7,0xC7,0x25,0x1D,0x63,0x0D,0xF3,0x56]
key = []
for i in range(8):
    key.append(ror(png[i] + i,i)^res[i])

def dec(a):
    buf = b''
    for i in range(8):
        buf += bytes([(rol(key[i]^a[i],i)-i)&0xff])
    return buf

f = open("C:/Users/42914/Desktop/flare-on/2021/2/Files/latin_alphabet.txt.encrypted",'rb')
s = f.read()
f1 = open("C:/Users/42914/Desktop/flare-on/2021/2/Files/latin_alphabet.txt",'wb')
s1 = b''

for i in range(0,len(s),8):
    if(i == len(s)-(len(s)%8)):
        enc = s[i:len(s)%8].ljust(8,b'\x50')
    else:
        enc = s[i:i+8]
    print(list(map(hex,list(enc))))
    s1 += dec(enc)
f1.write(s1)
f.close()
f1.close()

**四、3**

64位系统调用传参方式：

​    首先将系统调用号 传入 rax，然后将参数 从左到右 依次存入 rdi，rsi，rdx，rcx， r8， r9寄存器中，返回值存在rax寄存器

调用方式：

​    syscall

**四、[SCTF2019]creakme**


from idc_bc695 import *
key1 = "sycloversyclover"
len1 = 16
j = 0
for i in range(0x404000, 0x404200):
    b = Byte(i)
    PatchByte(i,~(b^ord(key1[j])))
    j += 1
    if j >= len1:
        j = 0



s = ">pvfqYc,4tTc2UxRmlJ,sB{Fh4Ck2:CFOb4ErhtIcoLo"
l = list(map(lambda x: ord(x)-1,list(s)))
l = l[::-1]
l = list(map(chr,l))
s1 = ""
print(s1.join(l))

http://tool.chacuo.net/cryptaes

解aes cbc
iv = sctfsctfsctfsctf
key = sycloversyclover

**五、[CISCN2018]2ex**
import base64
import string

str1 = "x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q"

string1 = '@,.1fgvw#`/2ehux$~\"3dity%_;4cjsz^+{5bkrA&=}6alqB*-[70mpC()]89noD'
string2 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"

tran = str.maketrans(string1,string2)
enc = "|_r-+_Cl5;vgq_pdme7#7eC0="
print(base64.b64decode(enc.translate(tran)))

**六、玄盾杯**

脱upx，去花，有些EBh还是什么E打头的和后面拼起来会形成一个奇怪的call，nop掉，有的时候跳转回到这个错误的指令的中间。得到一个迷宫，很快就能出。

**七、天津垓**

解法一、
a = "Rising_Hopper!"
b = [17,8,6,10,15,20,42,59,47,3,47,4,16,72,62,0,7,16]
for i in range(18):
    for j in range(33,128):
        if ((~(j&ord(a[i%14])))&(j|ord(a[i%14]))==b[i]):
            print(chr(j),end='')

这里是没什么值得学习的爆破

解法二、
a = "Rising_Hopper!"
b = [17,8,6,10,15,20,42,59,47,3,47,4,16,72,62,0,7,16]
for i in range(len(b)):
    print(chr(b[i]^ord(a[i%14])),end='')
print()

这里是值得学习的逻辑运算法则，参考资料见下：

https://zhuanlan.zhihu.com/p/385755926

https://zhidao.baidu.com/question/1372229323357112459.html

解法三、
from z3 import *
Str = [BitVec('s%d'%i,8) for i in range(18)]
solver = Solver()
for i in range(0, 17):
    solver.add(And(Str[i]>=32,Str[i]<=0x7e))
key = 'Rising_Hopper'
v1 = [17,8,6,10,15,20,42,59,47,3,47,4,16,72,62,0,7,16]
v7 = "Rising_Hopper!"
for i in range(0,18):
    tmp1 = ~(Str[i] & ord(v7[i % 14]))
    tmp2 = Str[i] | ord(v7[i % 14])
    solver.add(tmp1 & tmp2 == v1[i])
if solver.check() == sat:
    result = solver.model()
    for i in range(18):
        print(chr(result[Str[i]].as_long()),end = '')        #这里是值得学习的z3顺序输出方法
    print()

**八、 QCTF babymips**

flag1 = list(map(ord,'Q|j{g'))
flag2 = [ 0x52, 0xFD, 0x16, 0xA4, 0x89, 0xBD, 0x92, 0x80, 0x13, 0x41, \
  0x54, 0xA0, 0x8D, 0x45, 0x18, 0x81, 0xDE, 0xFC, 0x95, 0xF0, \
  0x16, 0x79, 0x1A, 0x15, 0x5B, 0x75, 0x1F]
def dec1(a):
    flag_dec = []
    for i in range(32):
        flag_dec.append(a[i]^(32-i))
    return flag_dec
def dec2(a):
    flag_dec = []
    k = 1
    for i in a:
        if(k %2 == 1):
            flag_dec.append(((i<<2)|(i>>6))&0xff)
        else:
            flag_dec.append(((i>>2)|(i<<6))&0xff)
        k += 1
    return flag_dec
print(''.join(map(chr,dec1(flag1+dec2(flag2)))))

**九、[SCTF2019]Who is he**

说明1：
dnspy 点进去CreateDecryptor，一直往上翻，可以看到加密模式
namespace System.Security.Cryptography
{
  // Token: 0x02000538 RID: 1336
  [ComVisible(true)]
  public abstract class SymmetricAlgorithm : IDisposable
  {
​    // Token: 0x060030DE RID: 12510 RVA: 0x000A80D4 File Offset: 0x000A62D4
​    protected SymmetricAlgorithm()
​    {
​      this.ModeValue = CipherMode.CBC;
​      this.PaddingValue = PaddingMode.PKCS7;
​      this.m_disposed = false;
​    }

说明2：
.net程序用的编码方式是unicode，每个字符后面都要加\x00的

说明3：
本题在程序运行的时候更改了内存，可用CE搜

from Crypto.Cipher import DES
import base64

l = [0x78 ,0x5A ,0x57 ,0x44 ,0x5A ,0x61 ,0x4B ,0x45 ,0x68 ,0x57 ,0x4E ,0x4D ,0x43 ,0x62 ,0x69 ,0x47 ,0x59 ,0x50 ,0x42 ,0x49 ,0x6C ,0x59 ,0x33 ,0x2B ,0x61 ,0x72 ,0x6F ,0x7A ,0x4F ,0x39 ,0x7A ,0x6F ,0x6E ,0x77 ,0x72 ,0x59 ,0x4C ,0x69 ,0x56 ,0x4C ,0x34 ,0x6E ,0x6A ,0x53 ,0x65 ,0x7A ,0x32 ,0x52 ,0x59 ,0x4D ,0x32 ,0x57 ,0x77 ,0x73 ,0x47 ,0x6E ,0x73 ,0x6E ,0x6A ,0x43 ,0x44 ,0x6E ,0x48 ,0x73 ,0x37 ,0x4E ,0x34 ,0x33 ,0x61 ,0x46 ,0x76 ,0x4E ,0x45 ,0x35 ,0x34 ,0x6E ,0x6F ,0x53 ,0x61 ,0x64 ,0x50 ,0x39 ,0x46 ,0x38 ,0x65 ,0x45 ,0x70 ,0x76 ,0x54 ,0x73 ,0x35 ,0x51 ,0x50 ,0x47 ,0x2B ,0x4B ,0x4C ,0x30 ,0x54 ,0x44 ,0x45 ,0x2F ,0x34 ,0x30 ,0x6E ,0x62 ,0x55 ,0x3D]

encrypted_data = '1Tsy0ZGotyMinSpxqYzVBWnfMdUcqCMLu0MA+22Jnp+MNwLHvYuFToxRQr0c+ONZc6Q7L0EAmzbycqobZHh4H23U4WDTNmmXwusW4E+SZjygsntGkO2sGA=='
encrypted_data = bytes(l)
key = b'1\x002\x003\x004\x00'
key = b't\x00e\x00s\x00t\x00'
generator = DES.new(key,DES.MODE_CBC,key)
res = generator.decrypt(base64.b64decode(encrypted_data))
print(res.decode("utf-16"))

**十、[FlareOn1]5get_it**

关于windows注册表

* 根键    注册表被划分为根键的5个顶层节
  * HKEY_LOCAL_MACHINE (HKLM)    保存对本地机器的全局设置
  * HKEY_CURRENT_USER (HKCU)   保存当前用户的特定的设置
  * HKEY_CLASSES_ROOT  保存定义的类型信息
  * HKEY_CURRENT_CONFIG   保存关于当前硬件配置的设置，特别是与当前和标准配置之间的不同部分
  * HKEY_USERS   定义默认用户、新用户和当前用户的配置
* 子键   一个子键就像是一个文件夹的子文件夹
* 键  一个键是一个注册表中的文件夹，它可以包含额外的文件夹或键值。
* 值项  一个值项是一个配对的名字和值
* 值或数据   值或数据是储存在注册表项中的数据。

两个最常用的根键是HKLM和HKCU。
向run子键写入项，是设置程序自启动的方法。Autoruns工具会检查注册表25~30个位置，来找到被设计成自动运行的代码。
常用函数：
**RegOpenKeyEx**   打开一个注册表进行编辑和查询。返回值为0成功

**RegSetValueEx**   添加一个新值到注册表，并设置它的数值。

**RegGetValue**   返回注册表中的一个值项的数指

**RegQueryValueExA**   检索与打开的注册表项关联的指定值名称的类型和数据。

**RegCreateKeyA**   创建指定的注册表项。如果注册表中已存在该键，则该函数会打开它。

本题用到的一些api

**GetModuleHandleExA**  检索指定模块句柄并增加模块引用计数

**GetModuleFileNameA**  检索包含指定模块的文件的完全限定路径。该模块必须已被当前进程加载。

**GetAsyncKeyState **  确定在调用函数时键是向上还是向下，以及在上一次调用**GetAsyncKeyState**后是否按下了键

具体解法请见s0uthwood师傅的博客，补充的是走进case分支之后总是眼花走错，所以可以把对应的函数重命名一下。

**十一、[FlareOn2]starter**

flag = [0x1F, 0x08, 0x13, 0x13, 0x04, 0x22, 0x0E, 0x11, 0x4D, 0x0D, \
0x18, 0x3D, 0x1B, 0x11, 0x1C, 0x0F, 0x18, 0x50, 0x12, 0x13, \
0x53, 0x1E, 0x12, 0x10]
print(''.join(map(lambda x:chr(x^0x7D),flag)))

**十二、[FlareOn2]elife**

见s0uthwood师傅博客

**十三、[ACTF新生赛2020]fungame**

没想到是个pwn和re结合的题，re是个异或，和一个Base64，中间有一步栈溢出跳转

**十四、[NPUCTF2020]BasicASM**

看汇编的题，奇偶位的处理是不同的

**十五、[HDCTF2019]Maze**

简单迷宫题，但程序编写的有点问题。

**十六、[watevrCTF 2019]Timeout**

终于见到了这个flag是视频地址的题目。

**十七、[dasctf] easy5cpp**

brainfuck代码运行的结果和密文做了个减法。

**十八、[dasctf] pig_brain_king**

这题名字叫猪脑王、、？

终于知道了recvuntil()的重要性

from pwn import *

p = process("./1.exe")
#p.recvuntil("question!\n")
p.recvuntil(b'questions!\r\n')
tmp = p.recvuntil(b'\r\n')[:-2]
print(p.recvuntil(b'enter:'))
p.sendline(tmp)
print(p.recvuntil(b'bingo!\r\n'))

for i in range(0,1000):
    p.recvuntil(b'questions!\r\n')
    tmp = p.recvuntil(b'\r\n')[:-2]
    p.recvuntil(b'enter:')
    p.sendline(tmp)
    p.recvuntil(b'bingo!\r\n')
    if(i % 100 ==0):
        print(i)

p.interactive()
#flag{Y0U_ar3_The_k1ng_0f_pig_bra1n!}

**十九、绿城杯RE**

本来还想用angr做，但发现跑不出来。然后胡师傅和我说用联合体做的（因为这个题的浮点数部分后面一半置零了，应该是丢失了很多精度，所以要与0xffffffff00000000）。用一个精度比较高的二元一次方程求解器（网上找的），就可以获得足够精度的答案了。然后写进C语言，再注意下大小端的转换，就能得到答案了。

**二十、羊城杯baby smc**

第一次见到这种不仅换表，而且换表之后好轮番异或的base64加密方式。这个smc动态调试就可以，调试到合适的位置，undefiend再建立函数就可以了。

**二十一、[SUCTF2018]babyre**

当我想反解的时候忘记了这个世界上有个东西叫爆破。

**二十二、Deltx**

这个题目使用动调可以看出它布尔运算经过了混淆，待解决的是使用静态分析看出如何实现的。

**二十三、[MRCTF2020]Shit**

a = [0x8c2c133a,0xf74cb3f6,0xfedfa6f2,0xab293e3b,0x26cf8a2a,0x88a1f279]
k = [0x03,0x10,0x0d,0x04,0x13,0x0b]
for i in range(5,-1,-1):
    if i > 0:
        a[i] ^= a[i-1]
    a[i] ^= (1<<k[i])
    a[i] = ((a[i]>>16) | (~(a[i]<<16) & 0xffff0000) )
    a[i] = ((a[i] << k[i]) | (a[i] >> (32 - k[i])) )& 0xffffffff
flag = b''
print(a)
for i in range(len(a)):
    flag += bytes.fromhex(hex(a[i])[2:])

print(flag)

关于花指令的分析



指令前缀

操作码

**ModR/M**

Mod 7-6    Reg/Opcode  5-3   R/M  2-0

ModR/M = FE 则 11111110  则  11 | 111 | 110    Mod:11    Reg:111  R/M:110        左边是E，代表内存或者寄存器R/M，上边是G，仅代表寄存器Reg。

**SIB**  Scale-Index-Base 辅助说明ModR/M

Scale 7-6   Index 5-3   Base  2-0

**Group**， 操作码为Group指令语句时，后面必须紧跟ModR/M



![image-20211010014722114](C:\hexo\source\_posts\image-20211010014722114.png)

花指令魔法

![image-20211010014813125](C:\hexo\source\_posts\image-20211010014813125.png)

EB是第三个，如果从第一个EB开始解析，那么解析后面一个byte-15h

![image-20211010014951398](C:\hexo\source\_posts\image-20211010014951398.png)

所以跳转到 0x4013C7 - 15h + 2(自身指令长度) = 0x4013B4

后面还有改表，genKey()赋值的时候有一个循环里面有个break，所以每次赋值的都是那个数组的第一个值，是一个迷乱别人的混淆。

注意下bytes.fromhex这个函数，这个函数可以把bytes.fromhex('666c')转换成b'fl'

**二十四、[ACTF新生赛2020]Splendid_MineCraft**

s1 = "3@1b;b"
s2 = "elcome "
flag1 = ""
for i in range(6):
    flag1+=chr((ord(s1[i])^ord(s2[i]))+35)
print(flag1)

l = [0x30,0x4,0x4,0x3,0x30,0x63,0x90]
table = [ 0xF6, 0xA3, 0x5B, 0x9D, 0xE0, 0x95, 0x98, 0x68, 0x8C, 0x65, 
  0xBB, 0x76, 0x89, 0xD4, 0x09, 0xFD, 0xF3, 0x5C, 0x3C, 0x4C, 
  0x36, 0x8E, 0x4D, 0xC4, 0x80, 0x44, 0xD6, 0xA9, 0x01, 0x32, 
  0x77, 0x29, 0x90, 0xBC, 0xC0, 0xA8, 0xD8, 0xF9, 0xE1, 0x1D, 
  0xE4, 0x67, 0x7D, 0x2A, 0x2C, 0x59, 0x9E, 0x3D, 0x7A, 0x34, 
  0x11, 0x43, 0x74, 0xD1, 0x62, 0x60, 0x02, 0x4B, 0xAE, 0x99, 
  0x57, 0xC6, 0x73, 0xB0, 0x33, 0x18, 0x2B, 0xFE, 0xB9, 0x85, 
  0xB6, 0xD9, 0xDE, 0x7B, 0xCF, 0x4F, 0xB3, 0xD5, 0x08, 0x7C, 
  0x0A, 0x71, 0x12, 0x06, 0x37, 0xFF, 0x7F, 0xB7, 0x46, 0x42, 
  0x25, 0xC9, 0xD0, 0x50, 0x52, 0xCE, 0xBD, 0x6C, 0xE5, 0x6F, 
  0xA5, 0x15, 0xED, 0x64, 0xF0, 0x23, 0x35, 0xE7, 0x0C, 0x61, 
  0xA4, 0xD7, 0x51, 0x75, 0x9A, 0xF2, 0x1E, 0xEB, 0x58, 0xF1, 
  0x94, 0xC3, 0x2F, 0x56, 0xF7, 0xE6, 0x86, 0x47, 0xFB, 0x83, 
  0x5E, 0xCC, 0x21, 0x4A, 0x24, 0x07, 0x1C, 0x8A, 0x5A, 0x17, 
  0x1B, 0xDA, 0xEC, 0x38, 0x0E, 0x7E, 0xB4, 0x48, 0x88, 0xF4, 
  0xB8, 0x27, 0x91, 0x00, 0x13, 0x97, 0xBE, 0x53, 0xC2, 0xE8, 
  0xEA, 0x1A, 0xE9, 0x2D, 0x14, 0x0B, 0xBF, 0xB5, 0x40, 0x79, 
  0xD2, 0x3E, 0x19, 0x5D, 0xF8, 0x69, 0x39, 0x5F, 0xDB, 0xFA, 
  0xB2, 0x8B, 0x6E, 0xA2, 0xDF, 0x16, 0xE2, 0x63, 0xB1, 0x20, 
  0xCB, 0xBA, 0xEE, 0x8D, 0xAA, 0xC8, 0xC7, 0xC5, 0x05, 0x66, 
  0x6D, 0x3A, 0x45, 0x72, 0x0D, 0xCA, 0x84, 0x4E, 0xF5, 0x31, 
  0x6B, 0x92, 0xDC, 0xDD, 0x9C, 0x3F, 0x55, 0x96, 0xA1, 0x9F, 
  0xCD, 0x9B, 0xE3, 0xA0, 0xA7, 0xFC, 0xC1, 0x78, 0x10, 0x2E, 
  0x82, 0x8F, 0x30, 0x54, 0x04, 0xAC, 0x41, 0x93, 0xD3, 0x3B, 
  0xEF, 0x03, 0x81, 0x70, 0xA6, 0x1F, 0x22, 0x26, 0x28, 0x6A, 
  0xAB, 0x87, 0xAD, 0x49, 0x0F, 0xAF]

flag = []
for i in range(0,6):
    flag.append(chr(table.index(l[i])^(i+131)))

print(flag)

ACTF{yOu0y*_knowo3_5mcsM<}

一言难尽。。单步调试会出bug



**二十五、V&NCTF2021 re notsudoku**
本题来自于胡师傅的教材配套练习题，详情请见胡师傅的博客，s0uthwood yyds！
from z3 import *

s = Solver()
hf = []
hf.append([Int('1_%d'%i) for i in range(5)])
hf.append([Int('2_%d'%i) for i in range(5)])
hf.append([Int('3_%d'%i) for i in range(5)])
hf.append([Int('4_%d'%i) for i in range(5)])
hf.append([Int('5_%d'%i) for i in range(5)])

for i in hf:
        s.add((i[0]+i[1]+i[2]+i[3]+i[4]) == 65)

for j in range(0,5):
    tmp = 0
    for i in hf:
        tmp += i[j]
    s.add(tmp == 65)

for i in range(0,5):
    for j in range(0,5):
        s.add(hf[i][j]>=0)

for i in range(25):        #这一招是rctf时ssgss教的
    for j in range(i+1,25):
        s.add(hf[i//5][i%5] != hf[j//5][j%5])

s.add(And(hf[0][1]==24, hf[4][3]==2, hf[0][2]==1, hf[2][3]==20, hf[1][0] ==23, hf[3][4]==3))
if s.check() == sat:
    model = s.model()
    for i in range(0,5):
        for j in range(0,5):
            print(model[hf[i][j]],end=' ')
        print()

**二十六、二十七、 zer0pts strcmp、WUSTCTF2020 level3**
感谢胡师傅提供的题目

第一题注意的是大小端，第二题是base换表操作
突然想到以后可以补一下windows和linux可执行文件启动过程



--> 
    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
            </div>
            <div class="post-nav-item">
                <a href="/2021/07/22/c%E8%AF%AD%E8%A8%80%E6%8C%87%E9%92%88/" rel="next" title="c语言指针">
                  c语言指针 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">NewbieReer</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  




  





</body>
</html>
